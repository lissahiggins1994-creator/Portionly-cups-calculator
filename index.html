function calcCups(targetCalories) {
  // higher-protein, still balanced
  const proteinPct = 0.34;  // more protein
  const carbPct    = 0.36;  // carbs slightly lower than before
  const fatPct     = 0.30;

  const proteinCals = targetCalories * proteinPct;
  const carbCals    = targetCalories * carbPct;
  const fatCals     = targetCalories * fatPct;

  let proteinCups = Math.round(proteinCals / KCAL_PER_CUP.Protein);
  let carbCups    = Math.round(carbCals    / KCAL_PER_CUP.Carbs);
  let fatCups     = Math.round(fatCals     / KCAL_PER_CUP["Healthy Fats"]);

  // minimums so it never goes weirdly low
  if (proteinCups < 3) proteinCups = 3;
  if (carbCups   < 2) carbCups   = 2;
  if (fatCups    < 1) fatCups    = 1;

  // soft maximums for sanity
  if (proteinCups > 7) proteinCups = 7;
  if (carbCups    > 8) carbCups    = 8;
  if (fatCups     > 4) fatCups     = 4;

  // ðŸ”‘ key rule: protein should not be lower than carbs
  if (proteinCups < carbCups) {
    proteinCups = carbCups;
  }

  // Veg & fruit scale gently with total energy
  let vegCups, fruitCups;
  if (targetCalories < 1600) {
    vegCups = 4;
    fruitCups = 2;
  } else if (targetCalories < 2100) {
    vegCups = 5;
    fruitCups = 3;
  } else {
    vegCups = 6;
    fruitCups = 3;
  }

  // Seeds & dressings: small flavour room that scales calmly
  let seedsCups;
  if (targetCalories < 1600) {
    seedsCups = 1;
  } else if (targetCalories < 2200) {
    seedsCups = 2;
  } else {
    seedsCups = 3;
  }

  return {
    Protein: proteinCups,
    Carbs: carbCups,
    Veggies: vegCups,
    Fruits: fruitCups,
    "Healthy Fats": fatCups,
    "Seeds & Dressings": seedsCups
  };
}
