<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Portionly Cup Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #f7f1ff;
      --card-bg: #ffffff;
      --accent: #f38fb8;
      --accent-strong: #d881ff;
      --text-main: #2b2136;
      --text-muted: #7b6a90;
      --border-subtle: #efe3ff;
      --radius-card: 22px;
      --shadow-soft: 0 18px 45px rgba(64, 33, 90, 0.16);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #ffe2ff 0, var(--bg) 38%, #f3f7ff 100%);
      color: var(--text-main);
    }

    .page-wrap {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 32px 16px;
    }

    .inner { max-width: 720px; width: 100%; }

    .logo {
      display: block;
      margin: 0 auto 12px;
      max-width: 140px;
    }

    .brand {
      text-align: center;
      font-size: 12px;
      letter-spacing: 0.18em;
      text-transform: lowercase;
      color: #a38ac7;
      margin-bottom: 6px;
    }

    .title {
      text-align: center;
      font-size: 26px;
      font-weight: 800;
      margin-bottom: 4px;
      letter-spacing: 0.02em;
    }

    .subtitle {
      text-align: center;
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 24px;
      max-width: 520px;
      margin-left: auto;
      margin-right: auto;
    }

    .card {
      background: var(--card-bg);
      border-radius: var(--radius-card);
      box-shadow: var(--shadow-soft);
      padding: 24px 22px 20px;
      border: 1px solid var(--border-subtle);
    }

    .card-header-text {
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 14px;
    }

    .field-group { margin-top: 18px; }
    .field { margin-bottom: 12px; }

    label {
      display: block;
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    input[type="number"],
    select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid #e1d4ff;
      background: #faf7ff;
      font-size: 14px;
      outline: none;
      transition: border 0.15s, box-shadow 0.15s, background 0.15s;
    }

    input[type="number"]:focus,
    select:focus {
      border-color: #c39bff;
      box-shadow: 0 0 0 2px rgba(186,145,255,0.25);
      background: #fff;
    }

    .grid-two {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
    }

    .unit-row {
      display: inline-flex;
      gap: 6px;
      flex-wrap: wrap;
      margin-top: 4px;
      margin-bottom: 8px;
    }

    .unit-pill {
      padding: 4px 12px;
      border-radius: 999px;
      border: 1px solid #f3e7ff;
      background: #fbf7ff;
      font-size: 11px;
      cursor: pointer;
      user-select: none;
      transition: all 0.2s;
    }

    .unit-pill.active {
      background: #ffc0d6;
      border-color: var(--accent);
      color: #fff;
    }

    .btn-main {
      margin-top: 16px;
      width: 100%;
      border-radius: 999px;
      padding: 14px 16px;
      border: none;
      font-size: 16px;
      font-weight: 700;
      background: linear-gradient(135deg,#ff9fc4,#d881ff);
      color: #fff;
      cursor: pointer;
      box-shadow: 0 10px 20px rgba(217,129,255,0.3);
    }

    .results {
      margin-top: 20px;
      padding: 20px;
      border-radius: 16px;
      background: #fdfaff;
      border: 2px solid #f1ddff;
      display: none;
    }

    .cups-list {
      list-style: none;
      padding: 0;
      margin: 15px 0;
    }

    .cups-list li {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #eee;
    }

    .error-msg {
      color: #d63031;
      font-size: 12px;
      margin-top: 10px;
      display: none;
    }
  </style>
</head>

<body>
  <div class="page-wrap">
    <div class="inner">
      <div class="brand">portionly wellbeing</div>
      <div class="title">Portionly Cup Calculator</div>
      <div class="subtitle">A simple guide for healthy daily habits.</div>

      <div class="card">
        <form id="calc-form">
          <div class="field">
            <label>Gender</label>
            <select id="gender">
              <option value="female">Female</option>
              <option value="male">Male</option>
            </select>
          </div>

          <div class="field">
            <label>Age (years)</label>
            <input id="age" type="number" placeholder="e.g. 34" required />
          </div>

          <div class="field">
            <label>Height</label>
            <div class="unit-row" id="height-units">
              <span class="unit-pill active" data-val="cm">cm</span>
              <span class="unit-pill" data-val="ftin">ft + in</span>
            </div>
            <div id="h-cm-input">
              <input id="heightCm" type="number" placeholder="Height in cm" />
            </div>
            <div id="h-ft-input" style="display:none;" class="grid-two">
              <input id="heightFt" type="number" placeholder="ft" />
              <input id="heightIn" type="number" placeholder="in" />
            </div>
          </div>

          <div class="field">
            <label>Weight</label>
            <div class="unit-row" id="weight-units">
              <span class="unit-pill active" data-val="kg">kg</span>
              <span class="unit-pill" data-val="lb">lbs</span>
              <span class="unit-pill" data-val="st">st + lb</span>
            </div>
            <div id="w-kg-input">
              <input id="weightKg" type="number" step="0.1" placeholder="Weight in kg" />
            </div>
            <div id="w-lb-input" style="display:none;">
              <input id="weightLb" type="number" step="0.1" placeholder="Weight in lbs" />
            </div>
            <div id="w-st-input" style="display:none;" class="grid-two">
              <input id="weightSt" type="number" placeholder="st" />
              <input id="weightStLb" type="number" step="0.1" placeholder="lb" />
            </div>
          </div>

          <div class="field">
            <label>Activity level</label>
            <select id="activity">
              <option value="1.2">Sedentary (mostly sitting)</option>
              <option value="1.375">Lightly active (1–3 days/week)</option>
              <option value="1.55">Moderately active (3–5 days/week)</option>
              <option value="1.725">Very active (6–7 days/week)</option>
            </select>
          </div>

          <button type="submit" class="btn-main">Show my cup plan</button>
          <div id="error-msg" class="error-msg">Please fill in all fields correctly.</div>
        </form>

        <div id="results" class="results">
          <h3 style="margin-top:0;">Your daily cup guide:</h3>
          <ul id="cups-list" class="cups-list"></ul>
          <p style="font-size:11px; color:var(--text-muted);">These are guidelines to help you find a balanced rhythm.</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // --- UI LOGIC: Switching Units ---
    function setupPills(containerId, inputMap) {
      const container = document.getElementById(containerId);
      const pills = container.querySelectorAll('.unit-pill');
      
      pills.forEach(pill => {
        pill.addEventListener('click', () => {
          // Update active class
          pills.forEach(p => p.classList.remove('active'));
          pill.classList.add('active');
          
          // Show correct input, hide others
          const selected = pill.getAttribute('data-val');
          Object.keys(inputMap).forEach(key => {
            document.getElementById(inputMap[key]).style.display = (key === selected) ? 'block' : 'none';
            if (key === selected && key.includes('ft')) document.getElementById(inputMap[key]).style.display = 'grid';
            if (key === selected && key.includes('st')) document.getElementById(inputMap[key]).style.display = 'grid';
          });
        });
      });
    }

    setupPills('height-units', { cm: 'h-cm-input', ftin: 'h-ft-input' });
    setupPills('weight-units', { kg: 'w-kg-input', lb: 'w-lb-input', st: 'w-st-input' });

    // --- MATH LOGIC ---
    const FORM = document.getElementById('calc-form');
    
    FORM.addEventListener('submit', (e) => {
      e.preventDefault();
      
      // 1. Convert everything to Metric
      let height = 0;
      const hUnit = document.querySelector('#height-units .active').dataset.val;
      if(hUnit === 'cm') {
        height = parseFloat(document.getElementById('heightCm').value);
      } else {
        height = (parseFloat(document.getElementById('heightFt').value || 0) * 30.48) + 
                 (parseFloat(document.getElementById('heightIn').value || 0) * 2.54);
      }

      let weight = 0;
      const wUnit = document.querySelector('#weight-units .active').dataset.val;
      if(wUnit === 'kg') {
        weight = parseFloat(document.getElementById('weightKg').value);
      } else if(wUnit === 'lb') {
        weight = parseFloat(document.getElementById('weightLb').value) * 0.453;
      } else {
        weight = (parseFloat(document.getElementById('weightSt').value || 0) * 6.35) + 
                 (parseFloat(document.getElementById('weightStLb').value || 0) * 0.453);
      }

      const age = parseFloat(document.getElementById('age').value);
      const gender = document.getElementById('gender').value;
      const activity = parseFloat(document.getElementById('activity').value);

      if(!height || !weight || !age) {
        document.getElementById('error-msg').style.display = 'block';
        return;
      }
      document.getElementById('error-msg').style.display = 'none';

      // 2. Calculate TDEE (Energy needed)
      const bmr = (10 * weight) + (6.25 * height) - (5 * age) + (gender === 'female' ? -161 : 5);
      const tdee = bmr * activity;
      
      // 3. Determine Cup Counts (Simplified Reliable Logic)
      // We prioritize Protein and Veggies
      let protein, carbs, fats, veg, fruit, seeds;

      if (tdee < 1600) {
        protein = 4; carbs = 3; veg = 4; fruit = 2; fats = 1; seeds = 1;
      } else if (tdee < 2000) {
        protein = 5; carbs = 4; veg = 5; fruit = 2; fats = 2; seeds = 1;
      } else if (tdee < 2400) {
        protein = 6; carbs = 5; veg = 5; fruit = 3; fats = 2; seeds = 2;
      } else {
        protein = 7; carbs = 6; veg = 6; fruit = 3; fats = 3; seeds = 2;
      }

      // 4. Display Results
      const list = document.getElementById('cups-list');
      list.innerHTML = `
        <li><span><strong>Pink</strong> Protein</span> <span>${protein} Cups</span></li>
        <li><span><strong>Yellow</strong> Carbs</span> <span>${carbs} Cups</span></li>
        <li><span><strong>Green</strong> Veggies</span> <span>${veg} Cups</span></li>
        <li><span><strong>Purple</strong> Fruit</span> <span>${fruit} Cups</span></li>
        <li><span><strong>Orange</strong> Fats</span> <span>${fats} Cups</span></li>
        <li><span><strong>Blue</strong> Seeds/Dressings</span> <span>${seeds} Cups</span></li>
      `;
      document.getElementById('results').style.display = 'block';
    });
  </script>
</body>
</html>
